<html>
<head>
  <title>js-ajax（下）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="721"/>
<h1>js-ajax（下）</h1>

<div>
<span><div style="display: block; margin: 0px; padding: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="font-size: 32px;">js-ajax（下）</span></div><div style="display: block; margin: 0px; padding: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><br/></div><div style="display: block; margin: 0px; padding: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-align: right;"><div style="display: block; margin: 0px; padding: 0px; text-align: right;"><div><span style="font-size: 16px;">作者： 千锋李文浩</span></div></div></div><div style="display: block; margin: 0px; padding: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-align: right;"><div><span style="font-size: 16px;">时间：   17/02/20</span></div></div><div><br/></div><div><br/></div><div><span style="font-size: 16px;"><span style="color: rgb(173, 0, 0);"><b>面试题（必问）重</b></span></span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">1、什么是跨域？</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">2、怎么解决跨域？有哪些方案？</span></span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><span style="color: rgb(51, 51, 51);">3、jsonp的原理是什么？</span></span></span></div></div><div><br/></div><div><br/></div><div><span style="font-size: 16px;"><span style="color: rgb(173, 0, 0);"><b>同源策略（重）</b></span></span></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>1、什么是同源？</div><div>     同源指的是域名、协议、端口号相同的域。</div><div><br/></div><div>2、同源策略是什么？</div><div>     1、它是由Netscape（网景公司）提出的一个著名的安全策略。</div><div>     2、同源策略规定了js代码的访问权限，只能访问和自己同源的页面。</div><div><br/></div><div>3、同源策略有什么用？</div><div>     保证网站的安全性。</div><div>     比如你现在是黑客，在浏览器中打开了支付宝的账户页面，随便打开了一个本地文件，这个文件里面你写了一段修改账户金额的js代码，如果没有同源策略，那么你的js代码就可以访问支付宝页面，后果自己想吧...</div></div><div><br/></div><div><br/></div><div><span style="font-size: 16px;"><span style="color: rgb(173, 0, 0);"><b>什么是跨域？（重）</b></span></span></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>1、跨域是指  在一个页面中使用js（ajax）访问另一个<span style="color: rgb(227, 0, 0);">不同源页面</span> (协议、域名、端口)  </div><div>  </div><div>     http://www.jd.com 要访问http://www.taobao.com   是不同域名  就叫跨域</div><div>     或者  <a href="http://www.baidu.com/">https://www.baidu.com</a>  要访问 <a href="https://www.baidu.com:80/">https://www.baidu.com:80</a>  也是跨域，端口号不一致</div><div><br/></div><div>3、<span style="color: rgb(227, 0, 0);">跨域问题是由于浏览器安全限制中的同源策略造成的.</span></div></div><div><br/></div><div><br/></div><div><span style="font-size: 16px;"><span style="color: rgb(173, 0, 0);"><b>怎么解决跨域？（重）</b></span></span></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>1、jsonp(客户端处理)</div><div><br/></div><div>2、CORS（服务器端）</div><div>常用的是这两种</div><div>更多方案自行百度，上面两种是现在公司常用的两种解决跨域的方案</div></div><div><br/></div><div><br/></div><div><span style="font-size: 16px;"><span style="color: rgb(173, 0, 0);"><b>jsonp跨域原理（重）</b></span></span></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>1、什么是jsonp？</div><div>     </div><div>     JSONP是一种非正式传输协议，用于解决跨域问题。</div><div><br/></div><div>2、jsonp 解决跨域的原理</div><div>    1、利用浏览器的“漏洞”，src不受同源策略的影响，可以请求任何链接</div><div>    2、动态创建script标签，将事先写好的函数名传给服务器 ，供服务器使用（返回函数调用代码）</div><div><br/></div><div>3、jsonp实现过程：</div><div>    1、创建一个全局函数</div><div>    2、创建一个script标签  var script = document.createElement('script');</div><div>    3、给script添加src</div><div>    4、给src添加回调函数名test(callback=test) <span style="color: rgb(227, 0, 0);"><b> callback是传给后台的一个参数</b></span></div><div>    5、将script放到页面上 document.body.appendChild(script);</div><div>    6、script请求完成，将自己从页面上删掉</div></div><div><br/></div><div><br/></div><div><b><span style="font-size: 16px;">实战</span></b></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>1、手机号查询</div><div>2、百度搜索</div><div>3、淘宝搜索</div></div><div><br/></div><div><br/></div><div><span style="font-size: 16px;"><span style="color: rgb(173, 0, 0);"><b>jsonp与json的区别（扩展）</b></span></span></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>1、jsonp是一种非正式传输协议</div><div><br/></div><div>2、json是一种数据格式</div></div><div><br/></div><div><br/></div><div><span style="font-size: 16px;"><span style="color: rgb(173, 0, 0);"><b>php方法json_encode()</b></span></span></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>json_encode() 将php数组转化为<span style="color: rgb(227, 0, 0);">json对象</span><br/></div></div><div><br/></div><div><br/></div><div><span style="font-size: 16px;"><span style="color: rgb(173, 0, 0);"><b>CORS解决跨域原理（重）</b></span></span></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>1、原理：</div><div>     在服务器端设置允许访问的域</div><div>     </div><div>2、php解决跨域</div><div>     header(&quot;Access-Control-Allow-Origin: *&quot;); //开启所有</div><div>     header(&quot;Access-Control-Allow-Origin: http://localhost&quot;);</div><div><br/></div><div>cors是一种技术</div></div><div><br/></div><div><br/></div><div><span style="font-size: 16px;"><b>思考</b></span></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>现有3个延时执行的函数 f1 f2 f3</div><div>f1 延时 1000秒</div><div>f2 延时 500毫秒</div><div>f3 延时 200毫秒</div><div><br/></div><div>怎么使执行顺序为  f1 -&gt; f2 -&gt; f3 ？</div></div><div><br/></div><div><br/></div><div><span style="color: rgb(173, 0, 0);"><span style="font-size: 16px;"><b>回调函数嵌套</b></span></span></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>1、链式运动</div><div><br/></div><div>2、嵌套ajax请求</div></div><div><br/></div><div><br/></div><div><span style="font-size: 16px;"><span style="color: rgb(173, 0, 0);"><b>Promise（重）</b></span></span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="color: rgb(51, 51, 51);"><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">1、<span style="color: rgb(173, 0, 0);">Promise 是异步编程的一种解决方案</span>，比传统的解决方案——回调函数和事件——更合理和更强大。</span></span></span></div><div><span style="color: rgb(51, 51, 51);"><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><br/></span></span></span></div><div><span style="color: rgb(51, 51, 51);"><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">2、它由社区最早提出和实现，ES6将其写进了语言标准，统一了用法，原生提供了Promise对象。</span></span></span></div><div><span style="color: rgb(51, 51, 51);"><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><br/></span></span></span></div><div><span style="color: rgb(51, 51, 51);"><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">3、<span style="color: rgb(173, 0, 0);"><b>常用于处理异步操作的嵌套</b></span></span></span></span></div><div><span style="color: rgb(51, 51, 51);"><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><b><span style="color: rgb(173, 0, 0);"><br/></span></b></span></span></span></div><div><span style="color: rgb(51, 51, 51);"><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><b><span style="color: rgb(173, 0, 0);">Promise学习网址：</span></b></span></span></span><a href="http://es6.ruanyifeng.com/#docs/promise">http://es6.ruanyifeng.com/#docs/promise</a></div><div><span style="font-size: 12px;">ES6学习网址：</span><a href="http://es6.ruanyifeng.com/">http://es6.ruanyifeng.com/</a></div></div><div><br/></div><div><br/></div><div><span style="font-size: 16px;"><span style="color: rgb(173, 0, 0);"><b>预习</b></span></span></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>1、什么是闭包？</div><div><br/></div><div>2、回顾构造函数</div><div><br/></div><div>3、什么是继承？继承的方式有哪些？</div></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 